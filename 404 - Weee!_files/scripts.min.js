function is_mobile_browser(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function is_windows_wechat(){var e=navigator.userAgent.toLowerCase();return/windowswechat/i.test(e)}function is_weixin_browser(){var e=navigator.userAgent.toLowerCase();return/micromessenger/i.test(e)||/windows phone/i.test(e)}function is_ios_browser(){return/iPad|iPhone|iPod/.test(navigator.userAgent)}function is_safari_browser(){var e=navigator.userAgent.toLowerCase();return/safari/i.test(e)&&!/(crios|chrome|fxios|firefox)/i.test(e)&&!is_weixin_browser()}function is_weee_browser(){var e=navigator.userAgent.toLowerCase();return"weeeapp"==e.match(/WeeeApp/i)}function is_kakao_browser(){var e=navigator.userAgent.toLowerCase();return/KAKAOTALK/i.test(e)}function is_alipay_browser(){var e=navigator.userAgent.toLowerCase();return/Alipay/i.test(e)}function supports_html5_storage(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}function format_time(e,t,o){var n=new Date(parseInt(e)),a=n.getFullYear()+"/"+pad(n.getMonth()+1,2)+"/"+pad(n.getDate(),2)+" "+pad(n.getHours(),2)+":"+pad(n.getMinutes(),2)+":"+pad(n.getSeconds(),2);return t&&(a+="."+n.getMilliseconds()),o&&(a+=" "+n.toString().match(/\(([A-Za-z\s].*)\)/)[1]),a}function format_date(e){var t=new Date(parseInt(1e3*e));return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()}function format_time_human_friendly(e,t){if("undefined"==typeof moment)return format_time(1e3*e,!1,!1);var o=moment.unix(e);if(!t&&o.diff(moment().startOf("hour"))>=0)return o.fromNow();var n=moment().startOf("day");return o.diff(n)>=0?o.format("LT"):n.diff(o)<864e5?lang("message_yesterday")+(t?" "+o.format("LT"):""):o.format("M/D/YY")+(t?" "+o.format("LT"):"")}function format_date_span(e){if("undefined"==typeof moment)throw"format_post_date() requires moment.js to be loaded first";e.each(function(e,t){var o=$(t),n=o.data("timestamp-format");n||(n="lll"),o.data("timestamp")?o.html(moment.unix(o.data("timestamp")).format(n)):o.html(moment(o.data("source")).format(n))})}function format_date_to_date(e,t){if("undefined"==typeof moment)throw"format_post_date() requires moment.js to be loaded first";var o="en"===get_site_language()||"es"===get_site_language()?"ddd MM/DD/YYYY":"YYYY-MM-DD dddd",n=t||o;e.each(function(e,t){var o=$(t);n||(n="lll"),o.data("timestamp")?o.html(moment(o.data("timestamp")).format(n)):o.html(moment(o.data("source")).format(n))})}function formatDate(e,t){return moment.unix(e).format(t||"M/D/YY")}function pad(e,t){return(1e15+e+"").slice(-t)}function weixin_window_close(){is_weixin_browser()&&WeixinJSBridge&&WeixinJSBridge.call("closeWindow")}function jump_login_page(e){"string"!=typeof e&&(e=window.location.href);var t=window.location.protocol+"//"+window.location.host+"/account/login?redirect_url="+encodeURIComponent(e);is_weee_browser()&&(t=window.location.protocol+"//"+window.location.host+"/login?redirect_url="+encodeURIComponent(e)),window.location=t}function lang_switch(e){is_weee_browser()&&(arg={language:lang},callAppFunction("changeLanguage",arg,null));var t=window.location.href;window.location="/lang_switch/to/"+e+"?url="+encodeURIComponent(t)}function init_like_button(e,t){var o="/like/get_likes/"+e.data("type")+"/"+e.data("target_id")+"/0";$.get(o,function(n){t?t(n):refresh_like_btn(e,n),e.data("user_id")?e.click(function(){e.addClass("loading"),$.post("/like/set_like",{type:e.data("type"),target_id:e.data("target_id")},function(n){$.get(o,function(o){e.removeClass("loading"),t?t(o):refresh_like_btn(e,o)})})}):e.click(jump_login_page)})}function refresh_like_btn(e,t){t.user_id&&e.data("user_id",t.user_id),t.user_liked?e.addClass("active"):e.removeClass("active");var o=e.children(".like-count");t.total>0?(o=e.children(".like-count"),0===o.length&&(o=$('<span class="badge like-count"></span>'),o.appendTo(e)),o.html(t.total)):o.remove(),e.blur()}function init_like_counters(){base_like_url="/like",$(".like-counter").each(function(){var e=$(this);$('<div class="counter"></div>').appendTo(e);var t=$('<button class="btn btn-default btn-sm btn-more-like">see more</button>');t.click(function(){load_more_like_images(e)}),$('<div class="images"></div>').append(t).appendTo(e);var o;o=e.data("user_id")?base_like_url+"/get_user_likes/"+e.data("type")+"/"+e.data("user_id"):base_like_url+"/get_likes/"+e.data("type")+"/"+e.data("target_id"),e.data("init_like_url",o),e.data("more_like_url",o),load_more_like_images(e)})}function load_more_like_images(e){e.find(".btn-more-like").button("loading"),$.get(e.data("more_like_url"),function(t){var o=e.find(".btn-more-like");if($(t.images).insertBefore(o),t.more_link?(e.data("more_like_url",t.more_link),o.button("reset")):o.hide(),t.first){var n=e.find(".counter");n.html("");var a='<i class="fas fa-plus"></i> Follow';e.data("text_like")&&(a=e.data("text_like"));var i=$('<a class="btn btn-default"></a>');if(t.user_id){var s;t.user_liked?(i.addClass("active"),s=e.data("text-unlike")?e.data("text-unlike"):"Following"):s=e.data("text-like")?e.data("text-like"):"+ Follow",i.html(s),i.click(function(){set_like(e)})}else i.click(jump_login_page);n.append(i),n.append('<span class="count-box"></span>'),n.find(".count-box").html(t.total)}$(e.data("count_selector")).html(t.total)})}function set_like(e){e.find(".counter").html('<a class="loading"></a><span class="count-box">...</span>'),$.post(base_like_url+"/set_like",{type:e.data("type"),target_id:e.data("target_id")},function(t){e.data("more_like_url",e.data("init_like_url")),e.find(".images a").remove(),load_more_like_images(e)})}function showLoading(e){e?show_grey_screen():remove_grey_screen()}function show_grey_screen(){var e=$('<div id="grey_screen"></div>');e.css({width:$(document).width(),height:$(document).height()}),e.appendTo($("body"))}function remove_grey_screen(){$("#grey_screen").remove()}function parse_server_output(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return{result:!1,message:e}}return e}function getUrlParameter(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),o=t.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function add_parameter_to_url(e,t,o,n){var a,i,s=!0;e.indexOf("#")>0?(i=e.indexOf("#"),a=e.substring(e.indexOf("#"),e.length)):(a="",i=e.length);var r=e.substring(0,i),l=r.split("?"),d="";if(l.length>1)for(var c=l[1].split("&"),u=0;u<c.length;u++){var p=c[u].split("=");s&&p[0]==t||(""===d?d="?":d+="&",d+=p[0]+"="+(p[1]?p[1]:""))}return""===d&&(d="?"),n?d="?"+t+"="+o+(d.length>1?"&"+d.substring(1):""):(""!==d&&"?"!=d&&(d+="&"),d+=t+"="+(o?o:"")),l[0]+d+a}function removeUrlParameter(e,t){var o=e.split("?");if(o.length>=2){for(var n=o.shift(),a=o.join("?"),i=encodeURIComponent(t)+"=",s=a.split(/[&;]/g),r=s.length;r-- >0;)s[r].lastIndexOf(i,0)!==-1&&s.splice(r,1);e=n+"?"+s.join("&")}return e}function format_div_more_less(e,t,o,n){"undefined"==typeof o&&(o="[Show More]"),"undefined"==typeof n&&(n="[Less]");var a=$('<div class="more-block">'+e.html()+"</div>");a.css("height",t).css("overflow","hidden");var i=$('<a class="more">'+o+"</a>");return e.addClass("more-less").html("").append(a).append(i),i.click(function(){$(this).hasClass("more")?(a.css("height","auto").css("overflow","visible"),$(this).removeClass("more").text(n),e.trigger("expended")):(a.css("height",t).css("overflow","hidden"),$(this).addClass("more").text(o),e.trigger("shrunk"))}),e}function add_input_clear_button(e){var t=e.parent();t.addClass("has-clear"),e.on("change",function(){""===e.val()?t.addClass("has-empty-value"):t.removeClass("has-empty-value")}).trigger("change"),$('<span class="fas fa-times form-control-clear" aria-hidden="true"></span>').on("click",function(){e.val("").trigger("change"),e.trigger("cleared")}).insertAfter(e)}function add_back_top_indicator(){var e=$("#back_top_indicator");if(0===e.length){var t=$('<a href="#"><i class="fas fa-arrow-up"></i></a>');t.click(function(){return $("body").animate({scrollTop:0},"slow"),!1}),e=$('<div id="back_top_indicator"></div>'),e.append(t).appendTo("body"),e.hide(),$(window).scroll(function(){var t=$(window).scrollTop()||document.documentElement.scrollTop||document.body.scrollTop;t>400?e.show():e.hide()})}}function button_loading(e,t){var o='<i class="fas fa-circle-notch fa-spin"></i>';return t||(o=o+" "+e.text()),e.data("resetText",null),e.data("loadingText",o),e.button("loading")}function showPageLoading(){if(!($(".full-loading").length>0)){$("body").append('<div class="full-loading"><div class="loading-icon"></div></div>');var e={container:document.querySelector(".loading-icon"),renderer:"svg",loop:!0,path:"../../js/json/loading.json"};lottie.loadAnimation(e)}}function stopPageLoading(){lottie.destroy(),$(".full-loading").remove()}function initAreaBlocks(e){for(var t=[],o=0;o<e.length;o++){var n=$(e[o]),a=$('<div class="area-block"></div>').data("idx",o);n.clone().appendTo(a);var i=$("<select></select>").addClass(n.attr("class")).addClass("hidden");i.change(function(){var e=$(this),o=e.closest(".area-block"),n=o.find("input"),a=o.data("idx");if(a<t.length-1){var i=t[o.data("idx")+1];e.val()?(i.addClass("loading"),_getAreaOptions(e.val(),function(t){i.removeClass("loading");var o=!1;e.val()&&"undefined"==typeof t.object.children&&(o=!0),_changeAreaBlockStyleByOptions(i,t.object,o)}),"readonly"==n.attr("readonly")&&e.attr("disabled","disabled")):_changeAreaBlockStyleByOptions(i,{})}n.val(e.val()),n.change(function(){n.is(":visible")||e.val($(this).val()).change()})}),i.appendTo(a),t.push(a),n.replaceWith(a)}_getAreaOptions(0,function(e){_changeAreaBlockStyleByOptions(t[0],e.object)})}function _changeAreaBlockStyleByOptions(e,t,o){var n="undefined"==typeof t.children,a=e.find("select"),i=e.find("input");i.toggleClass("hidden",!n),a.toggleClass("hidden",n),o||_initSelectOptions(a,t.children,i.val())}function _getAreaOptions(e,t){$.get("/deal/api_get_area_options/"+e,t)}function _initSelectOptions(e,t,o){e.html('<option value="">-- Choose --</option>');var n=!1;t&&$.each(t,function(t,a){e.append($("<option>",{value:a.id,text:a.area})),a.id==o&&(n=!0)}),o=n?o:"",e.val(o).trigger("change")}function initTagSelect(e,t,o,n){"undefined"==typeof o&&(o=1),"undefined"==typeof n&&(n=4);var a=!!navigator.userAgent.match(/MSIE 10/i),i=!!navigator.userAgent.match(/Trident.*rv\:11\./),s=i||a?"":lang("max_"+n+"_tags"),r=e.select2({placeholder:s,allowClear:!0,maximumSelectionLength:n,tags:!0,minimumInputLength:o,tokenSeparators:[",","，"],language:{noResults:function(){return""},inputTooShort:function(){return""},maximumSelected:function(){return lang("max_"+n+"_tags")}},ajax:{url:t,cache:"true"}});return r.on("select2:unselect",function(t){e.find("option").not(":selected").remove()}),r}function initKeywordSelect(e,t,o){"undefined"==typeof o&&(o=1);var n=(!!navigator.userAgent.match(/MSIE 10/i),!!navigator.userAgent.match(/Trident.*rv\:11\./),""),a=e.select2({placeholder:n,allowClear:!0,maximumSelectionLength:10,tags:!0,minimumInputLength:o,tokenSeparators:[",","，"],language:{noResults:function(){return""},inputTooShort:function(){return""},maximumSelected:function(){return""}},ajax:{url:t,cache:"true"}});return a.on("select2:unselect",function(t){e.find("option").not(":selected").remove()}),a}function showLangModal(e,t){var o=$('<div id="languageModal" class="modal fade bs-example-modal-sm"></div>'),n=$('<div class="modal-dialog"></div>'),a=$('<div class="modal-content"></div>'),i=$('<div class="content"><div class="choose-language"><span>Which language do you prefer?</span><br /><span>请选择您的常用语言</span></div></div>'),s=$('<div class="language-btn"></div>'),r=$('<button type="button" id="choose-english" class="btn btn-default" data-loading-text="">English</button>');r.click(function(){button_loading($(this));var e=t;lang_switch(e)}),r.appendTo(s);var l=$('<button type="button" id="choose-chinese" class="btn btn-default" data-loading-text="">简体中文</button>');l.click(function(){button_loading($(this));var t=e;lang_switch(t)}),l.appendTo(s),s.appendTo(i),i.appendTo(a),a.appendTo(n),n.appendTo(o),o.appendTo($("body")),$("#languageModal").modal({backdrop:"static",keyboard:!1}),is_body_blur(!0)}function showActionSheet(e){e.cancel={label:lang("cancel")};var t="weee-action-sheet";$("footer .navbar-fixed-bottom").length>0&&(t+=" fixed-footer-bottom"),bootbox.dialog({className:t,message:" ",onEscape:!0,buttons:e})}function getCookie(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),c_start!=-1)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""}function setCookie(e,t,o,n){var a=";";if(n=n||cookieDomain||"",n=n?"Domain="+n+";":"",o){var i=new Date;i.setDate(i.getDate()+o),a+="expires="+i.toGMTString()}var s=escape(t)+a;document.cookie=e+"="+s+";path=/;"+n}function set_moment_locale(e){"zh"==e&&(e="zh_cn"),"zh-Hant"==e&&(e="zh"),moment.locale(e)}function showOpenInAppButton(){if(!is_weee_browser()&&is_mobile_browser()&&!is_kakao_browser()&&!is_alipay_browser()){var e=navigator.userAgent.toLowerCase();if(!e.match(/aliapp/i)&&!getCookie("hide_open_in_app")){var t=$(".bottom-fix-footer, .navbar-fixed-bottom .container").outerHeight();t+=$(".new-gift-banner.container:not(:hidden)").length>0?$(".new-gift-banner.container").outerHeight()-1:0;var o=$('<div class="open-in-app-container" style="bottom:'+t+'px"></div>'),n=$('<div class="open-in-app-button"></div>').appendTo(o);$('<div class="close-button"></div>').click(function(){o.remove(),setCookie("hide_open_in_app",!0)}).appendTo(n);var a='<div class="desc-container">                        <div class="desc-logo"></div>                        <div class="desc-content">                            <div class="desc-title">Weee! App</div>                            <div class="desc-details">'+lang("download_app_subtitle")+"</div>                        </div>                    </div>";$(a).appendTo(n),$('<div class="action">'+lang("btn_download_app")+"</div>").click(function(){var e=navigator.userAgent,t=e.indexOf("Android")>-1||e.indexOf("Adr")>-1;if(t){var o="https://play.google.com/store/apps/details?id=com.sayweee.weee";window.location.href=o}else{var o="/log/to_link?type=download_app&target=open_in_app&url="+encodeURIComponent("http://app.sayweee.com/download.php?url="+encodeURIComponent(window.location.href));window.open(o)}}).appendTo(n),o.appendTo("body");var i=parseInt($("body").css("paddingBottom"))+o.outerHeight();$("body").css("padding-bottom",i)}}}function setBodyBlur(e){$("header,.main-content,.event-banner,.deal-error-status,.deal-notice,.gl_common_info,.gl_row,footer").toggleClass("filter-blur-2",e)}function is_body_blur(e){e?$("header nav,.main-content,.full-content,.event-banner,footer").addClass("filter-blur-2"):$("header nav,.main-content,.full-content,.event-banner,footer").removeClass("filter-blur-2")}function fixedBody(){var e=document.body.scrollTop||document.documentElement.scrollTop;document.body.style.cssText+="position:fixed;left:0;right:0;top:-"+e+"px;"}function looseBody(){var e=document.body;e.style.position="";var t=e.style.top;0!=t&&(document.body.scrollTop=document.documentElement.scrollTop=-parseInt(t),e.style.top="")}function showBottomFloatTip(e,t,o){if("0"!=getCookie("h_bottom_notification")){logUserAction("show_free_delivery","show");var n=$('<div class="weee-bottom-tip-container"></div>').appendTo("body"),a="";if("delivery_fee"===e.type){if(a="<div class='title'>👋 Hi "+e.parameters.user_name+"</div><div class='content'>"+e.parameters.message+"</div>",e.parameters.end_time&&e.parameters.end_time>e.parameters.time){var i=(new Date).getTime()-1e3*e.parameters.time,s=function(){var t=1e3*e.parameters.end_time-(new Date).getTime()+i;if(t>=0){var o=moment.utc(t).format("mm:ss");o=("00"+parseInt(t/36e5)).substr(-2)+":"+o,$("#free_delivery_before_finish").html(o.replace(/(\d{1})/g,"<span class='t'>$1</span>")),setTimeout(s,1e3)}else window.location.reload(!0)};s()}}else a="<div class='title'>👋 Hi "+e.parameters.name+"</div><div class='content'>"+e.parameters.message_1+"<span class='other-option-tip'>"+e.parameters.message_2+"</span>",e.parameters.link_text&&(a+="<a class='check-more' href='"+e.parameters.link_url+"'>"+e.parameters.link_text+"</a>"),a+="</div>";var r=$("<div class='tip-content'>"+a+"</div>").appendTo(n);$('<i class="close-btn fal fa-times"></i>').click(function(){closeOrderFreeDelivery(t,o)}).appendTo(r);var l,d;$(".weee-bottom-tip-container").on("touchstart",function(e){l=e.originalEvent.changedTouches[0].pageX,d=e.originalEvent.changedTouches[0].pageY}).on("touchend",function(e){var n=e.originalEvent.changedTouches[0].pageY,a=e.originalEvent.changedTouches[0].pageX,i=n-d,s=a-l;(i>0||s<0)&&closeOrderFreeDelivery(t,o)}),$(".open-in-app-container").length>0&&$(".open-in-app-container").hide(),$(".new-gift-banner").length>0&&$(".weee-bottom-tip-container").addClass("move-up");var c=parseInt($(".weee-bottom-tip-container").css("bottom"));is_weee_browser()&&callAppFunction("getDeviceInfo",null,function(e){e.result&&e.object&&e.object.tabbarExtensionHeight&&(c+=parseInt(e.object.tabbarExtensionHeight),$(".weee-bottom-tip-container").css("bottom",c))})}}function closeOrderFreeDelivery(e,t){logUserAction("hide_free_delivery","hide"),$(".weee-bottom-tip-container").remove(),$.post("/api_me_v1/set_user_default",{key:"bottom_notification"},function(o){o.result&&is_weee_browser()&&""!=e&&callAppFunction("preOrderStatusNotify",{pre_order_id:e,token:t,status:"extraInfoChanged"})}),$(".open-in-app-container").length>0&&$(".open-in-app-container").show()}function showBottomFloatToast(e){toastr.options={positionClass:"weee-bottom-result-toastr",hideDuration:"300",timeOut:"2000"},$.extend(toastr.options,e),toastr.info(e.text)}function addMovableRowSupport(e){var t='<div class="btn-group btn-group-sm btn-group-opt" role="group">        <button type="button" class="btn-movable-group btn-up">  </button>  <button type="button" class="btn-movable-group btn-down">    </button>  <button type="button" class="btn-movable-group btn-remove">  </button></div>';"TR"==e.prop("tagName")&&(t="<td>"+t+"</td>");var o=$(t);o.find(".btn-up").click(function(){e.index()>0&&exchangeRow(e.prev(),e)}),o.find(".btn-down").click(function(){var t=e.parent().children(".movable-row").length;e.index()<t-1&&exchangeRow(e,e.next())}),o.find(".btn-remove").click(function(){e.slideUp(function(){e.remove()})}),"TR"==e.prop("tagName")?e.addClass("movable-row").append(o):e.addClass("movable-row").prepend(o)}function exchangeRow(e,t){e.addClass("moving"),t.addClass("moving");var o=t.offset().top-e.offset().top;$.when(t.animate({top:-o}),e.animate({top:o})).done(function(){e.css("top","0px"),t.css("top","0px"),e.removeClass("moving"),t.removeClass("moving"),e.insertAfter(t)})}function showZipcodeDlg(e,t){function o(){var e;e=i.showCloseButton?'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>':"";var t='<div id="zipcodeModal" class="modal fade bs-example-modal-sm">            <div class="modal-content modal-dialog">        <div class="modal-body"><div class="title">'+e+'<div class="zip-title"> <span class="ui_title"></span><p class="ui_sub_title"></p><div class="error_message"></div></div></div><form>            <i class="sp-main zip_map_icon"></i> <input type="text" name="keyword" value="" placeholder="" id="keyword-id" />            <div id="keyword_append"></div>            <button type="submit" id="save-btn" class="btn btn-default"></button>          </form>          <div class="select-lang">            <div class="t"><span>language</span></div>            <button data-key="en">EN</button>            <button data-key="zh">简</button>            <button data-key="zh-Hant">繁</button>            <button data-key="es">Español</button>          </div>        </div>      </div>    </div>';$(t).appendTo($("body"));var o=$("#zipcodeModal");i.showCity&&($("#keyword-id").autocomplete({delay:500,source:"/area/api_query_area_info",minLength:1,select:function(e,t){$("#keyword-id").val(t.item.value),$("#zipcodeModal form").submit()},classes:{"ui-autocomplete":"weee-zipcode"}}),$("#keyword-id").autocomplete("widget").off("mouseenter")),i.showChangeLang?o.find(".select-lang button").click(function(){var e=$(this).data("key"),t=button_loading($(this),!0);$.post("/area/api_zipcode_modal_change_lang",{lang:e},function(o){t.button("reset"),o.result&&(a=e,s=o.object,n())})}):o.find(".select-lang").remove(),$("#zipcodeModal form").submit(function(e){e.preventDefault();var t=button_loading($("#save-btn")),o=$.param({support_address_str:i.showCity?1:0});$.post(i.targetUrl,o+"&"+$(this).serialize(),function(e){if(i.resultTargetCallBack)return t.button("reset"),i.onAfterCallBack(e);if(e.result)window.location.href=add_parameter_to_url(window.location.href,"t",(new Date).getTime());else{t.button("reset");var o=e.message?e.message:e;$("#zipcodeModal .zip-title p").addClass("hidden"),$("#zipcodeModal .error_message").html(o)}})}),$("#zipcodeModal").on("show.bs.modal",function(e){is_body_blur(!0)}),$("#zipcodeModal").on("hide.bs.modal",function(e){is_body_blur(!1),$("#keyword-id").val(""),$("#zipcodeModal .zip-title p").removeClass("hidden"),$("#zipcodeModal .error_message").html("")}),$("#zipcodeModal input").on("blur",function(e){document.body.scrollTop=document.body.scrollTop})}function n(){var e=$("#zipcodeModal");e.find(".select-lang button").removeClass("hidden"),e.find('.select-lang button[data-key="'+a+'"]').addClass("hidden"),e.find(".error_message").empty(),e.find(".ui_title").text(s.title),e.find(".ui_sub_title").text(i.showCity?s.subTitleShowCity:s.subTitle).removeClass("hidden"),e.find("form input[name='keyword']").attr("placeholder",s.placeholder).val(""),e.find("form :submit").text(s.btnConfirm)}var a=get_site_language(),i=$.extend({showCloseButton:!0,showCity:!1,showChangeLang:!0,targetUrl:"/area/api_set_zipcode",onAfterCallBack:$.noop,resultTargetCallBack:!1},e),s=$.extend({title:lang("zipcode_modal_title"),subTitle:lang("zipcode_modal_sub_title"),subTitleShowCity:lang("enter_city_or_zip_code"),placeholder:lang("member_choose_zipcode_input"),btnConfirm:lang("seller_confirm")},t);if(ENV.isOnRoot&&(s.title="Howdy!",s.subTitle="Start browsing with your zip code",s.placeholder="12345",s.btnConfirm="Go"),i.showCity&&void 0===$.fn.autocomplete)throw"load jquery-ui.js first";$("#zipcodeModal").length<1&&o(),n();var r=i.showCloseButton?{}:{backdrop:"static",keyboard:!1};$("#zipcodeModal").modal(r)}function load_js(e,t,o,n){show_grey_screen(),$.ajax({url:e,type:"GET",timeout:2e4,dataType:"script",success:function(){remove_grey_screen(),"function"==typeof t&&t()},error:function(e,t){console.log(t),n&&toastr.warning(n),remove_grey_screen(),"function"==typeof o&&o()}})}function initPtFilterStyle(){var e=0;$("#pt-filter .list-filter .filter-item").each(function(){e+=$(this).outerWidth(!0)}),$("#pt-filter").toggleClass("hidden-dropdown-toggle",e<$("#pt-filter .list-filter-wrapper").width())}function scrollPtFilterForShowSelectedItem(){var e=$("#pt-filter .filter-item.selected"),t=e.offset().left,o=t+e.width()+30+57,n=$(".list-filter-wrapper").width();if(t<0||o>n){var a=t-$(".list-filter").offset().left;$(".list-filter-wrapper").animate({scrollLeft:a-50})}}function logUserAction(e,t){$.post("/log/user_action",{action_type:e,action_target:t,para1:arguments[2],para2:arguments[3]},function(e){})}function logUserImpression(e,t){if(0!==t.length){var o=window.trackSdk.getPageKey();o?logUserActionDataBySDK(e,t):$.post("/log/user_impression",{action_type:e,target_objs:t},function(e){})}}function WF_SubPageSwitcher(e,t){this.pages=e,this.baseUrl=window.location.href,this.currentPageIdx=0,this.options=$.extend({pushStateUrlParameter:null,documentTitles:[]},t),this.forward=function(){if(this.currentPageIdx>=this.pages.length-1)return void console.error("Can not forward");if(this.currentPageIdx++,this.options.pushStateUrlParameter){var e=add_parameter_to_url(document.location.href,this.options.pushStateUrlParameter,this.currentPageIdx);history.pushState({},document.title,e)}this._showPage()},this.canBack=function(){return this.currentPageIdx>0},this.back=function(){if(!this.canBack())return void console.error("Can not back");if(this.currentPageIdx--,this.options.pushStateUrlParameter)window.history.back();else{this._showPage();var e=this.pages[this.currentPageIdx];e.css("margin-left",e.width()+"px").animate({"margin-left":0})}},this.jumpOnUrl=function(){if(!this.options.pushStateUrlParameter)return void console.error("No defined parameter name");var e=parseInt(getUrlParameter(this.options.pushStateUrlParameter));this.currentPageIdx=e||0,this._showPage()},this._showPage=function(){for(var e=0;e<this.pages.length;e++){var t=this.pages[e];t.toggleClass("hidden",e!=this.currentPageIdx)}this.currentPageIdx<this.options.documentTitles.length&&this.currentPageIdx>=0&&$("header .header-title").html(this.options.documentTitles[this.currentPageIdx])},this._showPage()}function addGiftCouponIcon(e){var t=$('<span id="signup_coupon_tip"></span>').click(function(){showCouponModal(e)}).appendTo($("body")),o=$(".main-content, .full-content");return FloatingTipUtils.addTouchMoveEvent(t,o),FloatingTipUtils.floatToContainerRight(t,o),null==e.user_id?11==e.group_id&&t.addClass("fubao"):10001!=e.group_id?(t.addClass("trending-user-coupon"),e.show_coupon_popup&&(showCouponModal(e),setCookie("coupon_tip",1,7)),t.append('<span class="x"></span>'),t.on("click",".x",function(e){t.hide(),setCookie("coupon_tip",2,7),e.stopPropagation()})):10001==e.group_id&&(t.addClass("memorial-day-point"),t.append('<span class="x"></span>'),t.on("click",".x",function(e){t.hide(),setCookie("memorial_day_point",!0,7),e.stopPropagation()})),t}function showCouponModal(e){var t=e.user_id;if(logUserAction("click_coupon_tip",e.group_id),t){if(10==e.group_id)return void showCouponEventModal({amount:1*e.amount,message:lang("sign_up_coupon_message"),isRemindStyle:!0});if(11==e.group_id)return void showFubaoEventModal();if(12==e.group_id)return void showCouponEventModal({amount:1*e.amount,isRemindStyle:!0});if(10001==e.group_id)return void(window.location="/points/buy")}var o="weee-modal ",n="",a="";11==e.group_id?(o+="fubao-coupon-modal",n=lang("porder_new_user_obtain_fubao"),a=lang("porder_full_fubao")):(o+="signup-coupon-modal",n=lang("porder_new_user_obtain_coupon"),a=lang("porder_full_cut_delivery").replace("{fee}",e.shipping_free_fee)),bootbox.dialog({className:o,title:n,message:a,buttons:{ok:{label:lang("porder_immediately_register"),callback:function(){window.location.href="/me/sign_up?redirect_url=/"}}}}),11==e.group_id&&$(".fubao-coupon-modal .modal-footer").append('<div class="tip">'+lang("porder_fubao_tip")+"</div>")}function showEventModel(e){if(logUserAction("click_coupon_tip",e.group_id),e.user_id){if(10==e.group_id)return void showCouponEventModal({amount:1*e.amount,message:lang("sign_up_coupon_message"),isRemindStyle:!0});if(11==e.group_id)return void showFubaoEventModal();if(12==e.group_id)return void showCouponEventModal({amount:1*e.amount,isRemindStyle:!0})}else{var t="weee-modal ",o="",n="";11==e.group_id?(t+="fubao-coupon-modal",o=lang("porder_new_user_obtain_fubao"),n=lang("porder_full_fubao")):(t+="signup-coupon-modal",o=lang("porder_new_user_obtain_coupon"),n=lang("porder_full_cut_delivery").replace("{fee}",e.shipping_free_fee)),bootbox.dialog({className:t,title:o,message:n,buttons:{ok:{label:lang("porder_immediately_register"),callback:function(){window.location.href="/me/sign_up?redirect_url=/"}}}})}}function initDashDealCountDown(e,t,o){var n=(new Date).getTime()-1e3*e,a=function(){var e=1e3*t-(new Date).getTime()+n;if(e>=0){var i=moment.utc(e).format("mm:ss");o&&(i=("00"+parseInt(e/36e5)).substr(-2)+":"+i),$("#count_down_before_finish").html(i.replace(/(\d{1})/g,"<span class='t'>$1</span>")),setTimeout(a,1e3)}else window.location.reload(!0)};a()}function updateCartQuantity(e,t,o,n){if(is_weee_browser()){var a=JSON.stringify({af_price:o.price,af_content_type:"n/a",af_content_id:o.id,af_content:o.title,af_quantity:o.quantity}),i={platform:"AF",event_name:"af_add_to_cart",event_parameter:a};callAppFunction("logEvent",i)}updateCartQuantityCache(e,t,o,n)}function updateCartQuantityCache(e,t,o,n){for(var a=0;a<updateCartCache.products.length;a++)updateCartCache.products[a].id===o.id&&updateCartCache.products.splice(a,1);updateCartCache.products.push(o),updateCartCache.lastUpdateTime=Date.now(),setTimeout(function(){if(!(Date.now()-updateCartCache.lastUpdateTime<290)){var o=updateCartCache.products;updateCartCache.products=[],_callSeverUpdateCartQuantity(e,t,o,n)}},300)}function _callSeverUpdateCartQuantity(e,t,o,n){if(0!==o.length){for(var a=[],i=0;i<o.length;i++){var s=o[i];if(a.push({pid:s.id,quantity:s.quantity,source:s.source,is_pantry:s.is_pantry}),fbq("track","AddToCart",{content_name:JSON.stringify(s.title),content_type:"product",contents:[{id:s.id,quantity:s.quantity,item_price:s.price}]}),"function"==typeof pixelAddToCart){var r={product_id:s.id,price:s.price,quantity:s.quantity};pixelAddToCart(r)}}var l=!1;if(is_weee_browser())if(is_ios_browser()){var d=/WeeeApp ((\d+.){2})/,c=navigator.userAgent.match(d),u=c[1].split(".");l=u[0]>4||4==u[0]&&u[1]>=8}else l=!0;$.post("/api_porder_v1/order/"+e+"/cart/update",{token:t,list:a,updatetime:(new Date).getTime(),event_update:o[0].isEvent},function(o){o.result&&l&&callAppFunction("preOrderStatusNotify",{pre_order_id:e,token:t,status:"addToCart"}),"function"==typeof n&&n(o)})}}function formateAmericaPhone(e){var t=(e||"").replace(/\D/g,"").match(/(\d{0,3})(\d{0,3})(\d{0,4})/);return t[1]?t[2]?"("+t[1]+") "+t[2]+(t[3]?"-"+t[3]:""):"("+t[1]:""}function formatPhoneToNumber(e){return(e||"").replace(/[\s|(|)|-]/g,"")}function showSmsDownloadModal(e,t){function o(e){return e--,s=e,s<=0?($("#message-save-btn").removeClass("disabled").text(d.btnConfirm),$("#message_modal .error_message").removeClass("success"),void $("#message_modal .error_message").html("")):($("#message-save-btn").addClass("disabled").text(e+"s, "+d.reset),void setTimeout(function(){o(e)},1e3))}function n(){var e="/log/to_link?type=download_app&para1=top&target=iphone&url="+encodeURIComponent("https://itunes.apple.com/app/apple-store/id921864548?mt=8"),t="/log/to_link?type=download_app&para1=top&target=android&url="+encodeURIComponent("https://play.google.com/store/apps/details?id=com.sayweee.weee"),n='<div id="message_modal" class="modal fade bs-example-modal-sm text-message-modal'+(l?" order-page":"")+'">                            <div class="modal-content modal-dialog">                                <div class="modal-body">                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>                                <img class="message-modal-left" src="/css/img/suspension/sms_download_'+i+'.png" />                                <div class="message-modal-right">                                    <form>                                     <h3 class="message-title">'+d.text+"</h3>"+(d.subTitle?"<p class='message-sub-title'>"+d.subTitle+"</p>":"")+'<div class="form-item">                                            <div class="error_message"></div>                                            <div class="form-item-line">                                                <span class="phone-prefix">+1</span>                                                <input maxlength="15" autocomplete="off" type="text" name="phone" id="text-phone"/>                                                <button type="submit" id="message-save-btn" class="phone-suffix">'+d.btnConfirm+"</button>                                            </div>                                        </div>                                    </form>"+(l?"<div class='message-footer'>                                        <div class='footer-item iphone'>                                            <a href="+e+">                                                <img src='/css/img/suspension/button_ios_"+i+".png'>                                            </a>                                        </div>                                        <div class='footer-item'>                                            <a href="+t+">                                                <img src='/css/img/suspension/button_google_"+i+".png'>                                            </a>                                        </div>                                        <div class='footer-item qr-code'>                                            <img src='/css/img/suspension/button_qr.png'>                                            <div class='download-app-right'><i></i></div>                                        </div>                                    </div>":"")+"</div>                            </div>                        </div>";
$(n).appendTo($("body")),$("#message_modal form").submit(function(e){e.preventDefault(),$("#message-save-btn").hasClass("disabled")||$.post(r.targetUrl,$.param({phone:formatPhoneToNumber($("#text-phone").val()||"")}),function(e){if(r.resultTargetCallBack)return r.onAfterCallBack(e);if(e.result)$("#message_modal .error_message").html('<i class="fa fa-check-circle"></i>'+e.message).addClass("success"),o(5);else{var t=e.message?e.message:e;$("#message_modal .error_message").html('<i class="fa fa-exclamation-circle"></i>'+t)}})}),$("#message_modal").on("show.bs.modal",function(e){is_body_blur(!0)}),$("#message_modal").on("hide.bs.modal",function(e){is_body_blur(!1),$("#message_modal .error_message").html("")}),$("#message_modal input").on("blur",function(e){document.body.scrollTop=document.body.scrollTop}).on("input",function(e){$(this).val(formateAmericaPhone(e.target.value))}),$("#message_modal input").focus(function(){$("#message_modal .error_message").html("")})}function a(){var e=$("#message_modal");e.find(".error_message").empty(),e.find(".message-title").html(d.text),e.find("form input[name='phone']").attr("placeholder",d.placeholder).val(""),e.find("form :submit").text(d.btnConfirm)}if(logUserAction("download_app","text_me"),!is_mobile_browser()){var i=get_site_language(),s=0,r=$.extend({isOrderPage:!1,showCloseButton:!0,showCity:!1,showChangeLang:!0,targetUrl:"/app_download/api_send_sms",onAfterCallBack:$.noop,resultTargetCallBack:!1},e),l=r.isOrderPage;l&&(t={text:lang("message_order_text"),subTitle:lang("message_sub_text")});var d=$.extend({text:lang("message_text"),placeholder:lang("message_phone_placeholder"),btnConfirm:lang("message_submit_text"),reset:lang("message_send_reset")},t);$("#message_modal").length<1&&n(),a();var c=r.showCloseButton?{}:{backdrop:"static",keyboard:!1};$("#message_modal").modal(c)}}function addAppDownloadFixedPopup(){if(!is_mobile_browser()){var e="/log/to_link?type=download_app&para1=top&target=iphone&url="+encodeURIComponent("https://itunes.apple.com/app/apple-store/id921864548?mt=8"),t="/log/to_link?type=download_app&para1=top&target=android&url="+encodeURIComponent("https://play.google.com/store/apps/details?id=com.sayweee.weee"),o='<div class="right-suspension">                    <div class="right-suspension-header">'+lang("download_suspension_text")+'</div>                    <div class="right-suspension-content">                        <div class="right-suspension-content-item apple-item">                            <div class="right-suspension-content-item-wrap apple">                                <a class="fab fa-apple" href="'+e+'"  />                                <span class="right-suspension-content-item-text">Apple store</span>                                <div class="right-suspension-content-item-line" />                            </div>                        </div>                        <div class="right-suspension-content-item">                            <div class="right-suspension-content-item-wrap google-play">                                <a class="fab fa-google-play" href="'+t+'"  />                                <span class="right-suspension-content-item-text">Google play</span>                                <div class="right-suspension-content-item-line" />                            </div>                        </div>                        <div class="right-suspension-content-item" id="qr-code">                            <div class="right-suspension-content-item-wrap suspension-qr">                                <i class="fal fa-qrcode"  />                                <span class="right-suspension-content-item-text">QR code</span>                                <div class="right-suspension-content-item-line" />                                <div class="download-app-right"><i></i></div>                            </div>                        </div>                        <div class="right-suspension-content-item" id="message_to">                            <div class="right-suspension-content-item-wrap message">                            <a class="fal fa-comment-lines"  />                            <span class="right-suspension-content-item-text">'+lang("download_message_text")+"</span>                        </div>                    </div>                </div>";$(o).appendTo($("body")),$("#message_to").on("click",function(){showSmsDownloadModal()}),$(window).width()<1350&&!window.location.href.match(/deal\/order_success/)&&$(".right-suspension").addClass("hidden")}}function buildUrl(e,t){return(t||"")+"/"+get_current_site_language()+(e||"")}function showSwitchDeliveryMethodArea(e,t){var o="",n=lang("modal_title_deliver").replace("%s",e),a=lang("modal_description_deliver");t&&(o="ship",titleText=lang("header_title_ship"),n=lang("modal_title_ship").replace("%s",e),a=lang("modal_description_ship"));var i='<div class="bg '+o+'">                    <div class="logo"></div>                 </div>',s='<div class="content-title">'+n+'</div>                   <div class="content-description">'+a+"</div>";bootbox.dialog({className:"weee-modal modal-switch-delivery-mothod",title:i,message:s,closeButton:!1,buttons:{ok:{label:lang("btn_shop_now"),callback:function(){setCookie("mail_order_show_popup",null,-1,cookieDomain)}}}})}function logUserActionDataBySDK(e,t){window.trackSdk.WeeeAnalytics.addEvent(e,window.trackSdk.getCommonBizParams(e,t)).send(md5(getCookie("weee_session_token")+Date.now()))}function logUserActionData(e,t,o){var n=window.location.origin.includes("www.sayweee.com")||window.location.origin.includes("sayweee.com"),a=e||(n?"https://api.sayweee.net/":"https://api.tb1.sayweee.net/"),i=(new Date).getTime(),s=getCookie("weee_session_token"),r=md5(s+i),l=parseInt((new Date).getTime()/1e3+"",10),o=Object.assign({},o,{url:window.location.pathname+window.location.search,page_url:window.location.href,referer:document.referrer,store:getCookie("weee-store"),source_store:getCookie("weee-store")}),d=window.trackSdk.getPageKey();d?logUserActionDataBySDK(t,o):$.ajax({type:"post",url:a+"ec/customer/event/track",data:JSON.stringify({event_items:[{type:t,params:o,time:l}],message_id:r}),headers:{"Content-Type":"application/json;charset=UTF-8","weee-session-token":s}})}function get12Cookie(e){var t=getCookie("weee_session_token"),o=getCookie(e).split(":"),n=o[1];return t===n?o[0]:""}function set12Cookie(e,t){var o=getCookie("weee_session_token");setCookie(e,t+":"+o)}function getAppVersion(){var e=navigator.userAgent.toLowerCase(),t=e.match(/weeeapp ((\d+.){4})/i);if(t){var o=(t[1]||"").trim()||"";return o.split(".").slice(0,-1).join(".")||""}return""}"undefined"!=typeof console&&"undefined"!=typeof console.log||(console={},console.log=function(){},console.error=function(){}),__DEBUG__=0,"undefined"==typeof debug_log&&(debug_log=function(e){__DEBUG__&&alert(e)});var CONSTANTS={HEADER_HEIGHT:44,WEEE_FACEBOOK_APPID:null},ENV={isOnRoot:0};if(toastr.options.positionClass="weee-flash-toastr",$(document).ready(function(){$(".header-right-more-content li").appendTo($(".head-right-more .dropdown-menu"))}),jQuery.cachedScript=function(e,t){return t=$.extend(t||{},{dataType:"script",cache:!0,url:e}),jQuery.ajax(t)},is_weee_browser()&&"undefined"==typeof _mobile_keyboard_fixed_fix){var _mobile_keyboard_fixed_fix=!0;$(document).on("focus",'input[type="text"], textarea, select',function(){setTimeout(function(){$("header>nav").css("position","relative"),$("footer>nav").css("position","relative"),$("body").css({"padding-top":0,"padding-bottom":0})},200)}),$(document).on("blur",'input[type="text"], textarea, select',function(){setTimeout(function(){$("header>nav").css("position",""),$("footer>nav").css("position",""),$("body").css({"padding-top":"","padding-bottom":""})},10)})}var base_like_url;!function(e){var t=function(t,o){var n=e.extend({},t),a={choosenBlock:o,initOptions:function(e,t){i(e,t)},getChoosenKeys:function(){return s()}},i=function(t,o){c.children("button").remove(),p.html(""),u.show(),t&&e.each(t,function(t,n){var a=r(t,n);e.inArray(t,o)!=-1&&(a.hide(),l(t,n))})},s=function(){var t=[];return c.find("button").each(function(){t.push(e(this).data("key"))}),t},r=function(t,o){var n=e('<button type="button" class="btn btn-default btn-sm"></button>');return n.attr("data-key",t).text(o),n.click(function(e){e.stopPropagation(),n.hide(),l(t,o)}),n.appendTo(p),n},l=function(t,o){u.hide();var n=e('<button type="button" class="remove btn btn-success btn-sm active"></button>');return n.attr("data-key",t).html(o+' <span class="glyphicon glyphicon-remove"></span>'),n.click(function(e){e.stopPropagation(),p.find('button[data-key="'+t+'"]').show(),n.remove(),0===c.children("button").length&&u.show()}),n.appendTo(c),n},d=e(o),c=e('<div class="choosen" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></div>'),u=e('<div class="placeholder">'+(n.placeholder?n.placeholder:"")+"</div>");u.appendTo(c);var p=e('<div class="dropdown-menu menus" aria-labelledby="tag-filter" style="opacity: 0.95;"></div>');return i(n.options,n.select),d.addClass("multi-choosen dropdown"),d.append(c).append(p),a};e.fn.multichoosen=function(e){return new t(e,this)}}(jQuery);var CartAnimationUtils={moveCartBallFrom:function(e,t,o){var n=e.offset().top-$(document).scrollTop()+5,a=e.offset().left,i=$("<span>",{class:"cart-ball",css:{top:n,left:a}});i.appendTo($("body"));var s=t.offset().top-$(document).scrollTop(),r=t.offset().left,l=50,d=2e3,c=a-r,u=s-n,p=Math.sqrt(2*l/d),m=Math.sqrt(2*(u+l)/d);i.animate({top:n-l,left:a-c/(p+m)*p},{duration:Math.round(1e3*p),specialEasing:{top:"easeOutQuad",left:"linear"},complete:function(){i.animate({top:s,left:r},{duration:Math.round(1e3*m),specialEasing:{top:"easeInQuad",left:"linear"},complete:function(){i.remove(),CartAnimationUtils.flashingCart(t),"function"==typeof o&&o()}})}})},flashingCart:function(e){setTimeout(function(){e.addClass("shopping-cart-scale-11"),setTimeout(function(){e.removeClass("shopping-cart-scale-11"),e.addClass("shopping-cart-scale-9"),setTimeout(function(){e.removeClass("shopping-cart-scale-9")},100)},100)},100)}};WF_ValidateHelper={bindValidation:function(e){e.find(".required").find("input,textarea").on("blur input change",function(){var e=WF_ValidateHelper.validateField($(this));$(this).closest(".required").toggleClass("wf-error",!e),$(this).closest(".required").toggleClass("wf-success",e)}),e.find(".required").find("input,textarea").on("focus",function(){var e=!1;$(this).closest(".required").toggleClass("wf-error",e),$(this).closest(".required").toggleClass("wf-success",!e)}),e.find(".required").find("input,textarea").each(function(){var e=WF_ValidateHelper.validateField($(this));$(this).closest(".required").toggleClass("wf-success",e),$(this).closest(".required").toggleClass("wf-error",!e)})},validateField:function(e){var t=e.val(),o=""===t||null===t||0===t.split(" ").join("").length;return!o},validate:function(e){e.find(".required").find("input,textarea").trigger("change");var t=e.find(".wf-error");return!(t.length>0&&(t.find(".form-control").first().focus(),1))}},DealCartStorageHelper={STORAGE_KEY:"DEAL_P_IDS",clearStorage:function(){supports_html5_storage()&&window.localStorage.removeItem(DealCartStorageHelper.STORAGE_KEY)},initQuantityFromStorage:function(e){if(supports_html5_storage()){var t=JSON.parse(window.localStorage.getItem(DealCartStorageHelper.STORAGE_KEY))||{},o=t[e];if(o&&!(o.expireTime<(new Date).getTime())){for(var n in o)o.hasOwnProperty(n)&&$('#form-deal input[name="'+n+'"]').val(o[n]);var a=!1;for(var i in t)t.hasOwnProperty(i)&&t[i].expireTime<(new Date).getTime()&&(delete t[i],a=!0);a&&window.localStorage.setItem(DealCartStorageHelper.STORAGE_KEY,JSON.stringify(t))}}},saveQuantityToStorage:function(e,t){if(supports_html5_storage()){var o=JSON.parse(window.localStorage.getItem(DealCartStorageHelper.STORAGE_KEY))||{};if(jQuery.isEmptyObject(t)){if(!o[e])return;delete o[e]}else t.expireTime=(new Date).getTime()+288e5,o[e]=t;window.localStorage.setItem(DealCartStorageHelper.STORAGE_KEY,JSON.stringify(o))}}};var FloatingTipUtils={floatToContainerRight:function(e,t){var o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=o-(t.offset().left+t.outerWidth());e.css("right",n)},addTouchMoveEvent:function(e,t){var o=e.width(),n=e.height();e.on("touchmove",function(e){var a=e.originalEvent.targetTouches[0],i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=a.clientX-o/2,l=a.clientY-n/2,d=t.offset();d.right=t.offset().left+t.outerWidth(),d.bottom=s-$("footer .navbar").outerHeight(),r<d.left?r=d.left:r>d.right-o&&(r=d.right-o),l<d.top?l=d.top:l>d.bottom-n&&(l=d.bottom-n),$(this).css({right:i-r-o+"px",bottom:s-l-n+"px"}),e.preventDefault()})}},updateCartCache={lastUpdateTime:null,products:[]};